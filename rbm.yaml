!obj:pylearn2.train.Train {
        dataset: !pkl: "train_preprocessed.pkl",

        model: !obj:pylearn2.models.rbm.GaussianBinaryRBM {
                nvis : 793,
                nhid : 1000,
                irange : 0.05,
                energy_function_class : !obj:pylearn2.energy_functions.rbm_energy.grbm_type_1 {},
                learn_sigma : True,
                init_sigma : 0.4,
                init_bias_hid : -2.0,
                mean_vis : False,
                sigma_lr_scale : 1e-3
        },

        algorithm: !obj:pylearn2.training_algorithms.sgd.SGD {
                learning_rate : 1e-1,
                batch_size : 5,
                monitoring_batches : 20,
                monitoring_dataset : !pkl: "train_preprocessed.pkl",
                cost : !obj:pylearn2.costs.ebm_estimation.SMD {
                        corruptor : !obj:pylearn2.corruption.GaussianCorruptor {
                                stdev : 0.4
                        },
                },
                termination_criterion : !obj:pylearn2.termination_criteria.MonitorBased {
                        prop_decrease : 0.01,
                        N : 1,
                },
        },

        extensions : [!obj:pylearn2.training_algorithms.sgd.MonitorBasedLRAdjuster {}],
        save_freq : 1
}
